"use strict";!function(){function e(){var e=m.filterData(o.from,o.to,o.message);e.hasOwnProperty("command")?("@"==e.command&&e.m.trim().length>0&&m.sendMessage(e,function(e){m.showMessage(s,e,!c),m.clearInput([o.message],o.message)}),">"==e.command&&m.searchBaiduImage(e.m,function(t){var n=m.formatImageSet(t);e.m=t,m.sendLocalSearch(e,function(e){e.m=n,console.log(e),m.showSearchResult(s,e),m.clearInput([o.message],o.message)})}),"help"==e.command&&(m.showMessage(s,e,c),m.clearInput([o.message],o.message)),"clear"==e.command&&(s.innerHTML="",m.clearInput([o.message],o.message)),"quit"==e.command&&(l.close(),window.close())):e.m.trim().length>0&&m.sendMessage(e,function(e){m.showMessage(s,e,!c),m.clearInput([o.message],o.message)})}function t(e,t){if("string"==typeof t)return e.getHours()+t+e.getMinutes()+t+e.getSeconds();console.log("the second argument should be string")}var n=document.getElementById("set"),s=document.getElementById("message_box"),o=document.getElementById("input"),a=document.getElementById("shadow"),c=!0,i=!1,m={},l={};if(localStorage.getItem("nick")){var u=localStorage.getItem("nick");document.getElementById("nick").value=u,document.getElementById("nick").focus()}a.addEventListener("click",function(){n.nick.focus()}),n.addEventListener("submit",function(e){e.preventDefault();var i=n.nick.value.trim();i.length>=5?(l=io("http://106.15.91.176:7878/"),l.on("connect",function(){m=new utalk.wsHandle(l,i),l.emit("regist",i,function(e){switch(e.code){case 0:n.nick.placeholder=e.m,n.nick.value="",n.nick.focus();break;case 1:localStorage.setItem("nick",i),a.style.opacity=0,o.from.value=i,o.message.focus(),setTimeout(function(){a.style.display="none"},505)}}),m.getClients(o.to),m.listen("message",function(e){m.showMessage(s,e,c)}),m.listen("new_user",function(){m.getClients(o.to)}),m.listen("user_not_in",function(e){m.showMessage(s,e,c)}),m.showMessage(s,{from:"Utalk",to:"nick",time:t(new Date,"-"),m:"欢迎使用Utalk，本软件属于Gaven Xu瞎胡闹产品，没有数据库，没有账号，没有表情包，没有好友记录，没有群组，不会记录任何信息，请放心使用，萍水相逢，能在一起聊天即是缘分，如有问题，请输入help命令查看帮助。",color:"#d04778"},c)})):(n.nick.placeholder="Try 5-20 letter",n.nick.value="",n.nick.focus())}),o.addEventListener("submit",function(t){t.preventDefault(),e()}),message.addEventListener("keydown",function(t){"16"!=t.keyCode||i||(i=!0),"13"!=t.keyCode||i||(t.preventDefault(),e()),"13"==t.keyCode&&i&&(t.preventDefault(),o.message.value+="\n",o.message.scrollTop=o.message.scrollHeight)}),message.addEventListener("keyup",function(e){"16"==e.keyCode&&(i=!1)})}();
//# sourceMappingURL=utalk.min.js.map
