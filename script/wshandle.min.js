"use strict";window.utalk=window.utalk||{},function(){function e(e,t){if("string"==typeof t)return e.getHours()+t+e.getMinutes()+t+e.getSeconds();console.log("the second argument should be string")}var t=function(e,t){this.socket=e,this.nick=t};t.prototype={listen:function(e,t){this.socket.on(e,t)},clearInput:function(e,t){if(e instanceof Array)for(var n=0;n<e.length;n++)e[n].value="";else alert(e+"不是数组");t&&t.focus()},filterData:function(t,n,o){var s={from:t.value.toString().trim(),to:n.value.toString().trim()||"all",m:o.value.toString().trim(),time:e(new Date,"-")};return 0==s.m.indexOf("@")&&(s.to=s.m.match(/^@(\S+\s*)/)[1].trim(),s.m=s.m.match(/^@(\S+\s*)/).input.replace("@"+s.to,""),s.command="@"),0==s.m.indexOf(">")&&(s.to=s.m.match(/^>(\S+\s*)/)[1].trim(),s.m=s.m.match(/^>(\S+\s*)/).input.replace(">",""),s.command=">"),/^help$/.test(s.m)&&(s.from="Utalk",s.to=t,s.time=e(new Date,"-"),s.m="\n                help 命令: 查看帮助<br>\n                quit 命令: 退出软件<br>\n                clear 命令: 清除屏幕内容<br>\n                > 命令: 查找百度图片<br>\n                @ 命令: 快速进行一次私聊<br>\n                ",s.color="#d04778",s.command="help"),/^clear$/.test(input.message.value)&&(s.to=t,s.command="clear"),/^quit$/.test(s.m)&&(s.to=t,s.command="quit"),/^(http\:\/\/|https\:\/\/).+(\.jpg|\.png|\.bmp|\.gif|\.jpeg)$/.test(s.m)&&(s.m="<img src='"+s.m+"'/>"),s},getClients:function(e){this.socket.emit("getClients",function(t){console.log(t),e.innerHTML='<option value="all" selected>all</option>';for(var n in t)t.hasOwnProperty(n)&&n!=this.nick&&(e.innerHTML+='\n                            <option value="'+n+'">'+n+"</option>\n                        ")}.bind(this))},sendMessage:function(e,t){e instanceof Object&&t instanceof Function&&this.socket.emit("message",e,t)},sendLocalSearch:function(e,t){e instanceof Object&&t instanceof Function&&this.socket.emit("localSearch",e,t)},formatImageSet:function(e){var t=this;if(e instanceof Array){var n=document.createElement("div");n.className="imgset remote";for(var o=0;o<e.length;o++){var s=document.createElement("img");if(s.className="img img"+o,console.log(e[o].imgSrc),s.src=t.decodeBaiduImageUrl(e[o].imgSrc),console.log(s.src),s.title=e[o].title,s.setAttribute("test",e[o].fromSite),n.appendChild(s),o==e.length-1)return n}}else console.log("error")},searchBaiduImage:function(e,t){var n=new XMLHttpRequest;n.open("GET","http://image.baidu.com/search/acjson?tn=resultjson_com&ipn=rj&ct=201326592&is=&fp=result&queryWord="+e+"&cl=&lm=&ie=utf-8&oe=utf-8&adpicid=&st=&z=&ic=&word="+e+"&s=&se=&tab=&width=&height=&face=&istype=&qc=&nc=&fr=&pn=60&rn=30&gsm=1e&1493171544246=",!0),n.onreadystatechange=function(){if(4!=n.readyState||200!=n.status)return null;var e=JSON.parse(n.responseText).data;console.log(e);for(var o=[],s=0;s<e.length;s++){var a=e[s].fromPageTitleEnc,i=e[s].replaceUrl?e[s].replaceUrl[1]?e[s].replaceUrl[1]:e[s].replaceUrl[0]:null;i&&o.push({title:a,fromSite:i.FromURL,imgSrc:e[s].objURL}),s==e.length-1&&t(o)}},n.send()},decodeBaiduImageUrl:function(e){var t={w:"a",k:"b",v:"c",1:"d",j:"e",u:"f",2:"g",i:"h",t:"i",3:"j",h:"k",s:"l",4:"m",g:"n",5:"o",r:"p",q:"q",6:"r",f:"s",p:"t",7:"u",e:"v",o:"w",8:"1",d:"2",n:"3",9:"4",c:"5",m:"6",0:"7",b:"8",l:"9",a:"0",_z2C$q:":","_z&e3B":".",AzdH3F:"/"},n=e,o=/(_z2C\$q|_z&e3B|AzdH3F)/g,s=n.replace(o,function(e,n){return t[n]}),a=/([a-w\d])/g;return s=s.replace(a,function(e,n){return t[n]})},showAlert:function(e,t){t.time,t.m},showSearchResult:function(e,t){if(console.log(t),t.command&&">"==t.command)return e.appendChild(t.m),e.scrollTop=e.scrollHeight,!0},showMessage:function(e,t,n){if(console.log(t),n)var o='\n                    <div class="remote">\n                        <div class="name">\n                            <span>'+t.from+'</span><span class="time">'+t.time+'</span>\n                        </div>\n                        <div class="message">\n                            <span style="color:'+(t.color||"#ffed00")+'">'+t.m+"</span>\n                        </div>\n                    </div>\n                    ";else var o='\n                    <div class="local">\n                        <div class="name">\n                            <span>'+t.from+'</span><span class="time">'+t.time+'</span>\n                        </div>\n                        <div class="message">\n                            <span style="color:'+(t.color||"#5fafef")+'">'+t.m+"</span>\n                        </div>\n                    </div>\n                    ";return e.innerHTML+=o,e.scrollTop=e.scrollHeight,!0}},utalk.wsHandle=t}();
//# sourceMappingURL=wshandle.min.js.map
